import{c as J,a as v,f as S,t as ge}from"../chunks/Cb8YqkPy.js";import{f as A,m as We,K as Ye,o as Ze,n as e,y as _,z as n,q as ea,v as a,x as l,$ as aa,E as w,A as t,b1 as N,F,b2 as ta}from"../chunks/De5Mxx5s.js";import{d as sa,s as U,e as ra}from"../chunks/f9BCEkia.js";import{E as la,e as xe,i as $e,b as oa,g as ia}from"../chunks/DjJm9GIN.js";import{l as X,s as G,i as z}from"../chunks/C9SOKrUf.js";import{h as na}from"../chunks/DT3rAyPD.js";import{I as Q,s as W,r as V,b as ke,c as ye,d as we}from"../chunks/CPCpnfcj.js";import{b as j}from"../chunks/ChvdF1no.js";import{g as Se}from"../chunks/CWAOWzZu.js";import{B as Pe}from"../chunks/ChWCjium.js";import{T as da,s as Ce}from"../chunks/BpuJyHZo.js";import{C as ca,i as va}from"../chunks/DsssenAb.js";import{u as ma}from"../chunks/C4xn7GUp.js";import"../chunks/COHsmaMF.js";import{C as Oe}from"../chunks/FSb_ML22.js";import{U as ha}from"../chunks/Dixf_sfU.js";function ua(x,h){const m=X(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=[["path",{d:"M12 7v14"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}]];Q(x,G({name:"book-open"},()=>m,{get iconNode(){return d},children:(f,p)=>{var c=J(),o=A(c);W(o,h,"default",{}),v(f,c)},$$slots:{default:!0}}))}function fa(x,h){const m=X(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=[["path",{d:"m15 18-6-6 6-6"}]];Q(x,G({name:"chevron-left"},()=>m,{get iconNode(){return d},children:(f,p)=>{var c=J(),o=A(c);W(o,h,"default",{}),v(f,c)},$$slots:{default:!0}}))}function pa(x,h){const m=X(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]];Q(x,G({name:"circle-check"},()=>m,{get iconNode(){return d},children:(f,p)=>{var c=J(),o=A(c);W(o,h,"default",{}),v(f,c)},$$slots:{default:!0}}))}function _a(x,h){const m=X(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10"}],["path",{d:"M18 5v17"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6"}],["path",{d:"M6 5v17"}],["circle",{cx:"12",cy:"9",r:"2"}]];Q(x,G({name:"school"},()=>m,{get iconNode(){return d},children:(f,p)=>{var c=J(),o=A(c);W(o,h,"default",{}),v(f,c)},$$slots:{default:!0}}))}var ba=S('<div class="max-w-md mx-auto"><div class="card-solid p-6 text-center"><!> <h2 class="text-xl font-semibold text-christmas-red-dark mb-2">Pendaftaran Ditutup</h2> <p class="text-gray-600">Maaf, batas waktu konfirmasi kehadiran sudah berakhir pada 31 Desember 2024.</p> <div class="mt-6"><!></div></div></div>'),ga=S("<option> </option>"),xa=S('<div class="animate-slideDown svelte-x3tsbi"><label for="schoolOther" class="form-label">Nama Sekolah</label> <input type="text" id="schoolOther" class="form-input" placeholder="Masukkan nama sekolah" required minlength="2"/></div>'),$a=S("<option> </option>"),ka=S('<div class="animate-slideDown svelte-x3tsbi"><label for="classOther" class="form-label">Nama Kelas (Format: Tingkat.Jurusan-Rombel)</label> <input type="text" id="classOther" class="form-input" placeholder="Contoh: X.RPL-3" required/></div>'),ya=S('<div class="animate-slideDown svelte-x3tsbi"><label for="reason" class="form-label">Alasan Tidak Hadir</label> <textarea id="reason" class="form-textarea" placeholder="Tuliskan alasanmu tidak bisa hadir..." required minlength="5"></textarea></div>'),wa=S('<div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"> </div>'),Sa=S('<div class="max-w-md mx-auto"><form class="card-solid p-6 space-y-5"><div><label for="name" class="form-label flex items-center gap-2"><!> Nama Lengkap</label> <input type="text" id="name" class="form-input" placeholder="Masukkan nama lengkap" required minlength="2"/></div> <div><label for="school" class="form-label flex items-center gap-2"><!> Asal Sekolah</label> <select id="school" class="form-select" required><option disabled>Pilih sekolah</option><!></select></div> <!> <div><label for="class" class="form-label flex items-center gap-2"><!> Kelas</label> <select id="class" class="form-select" required><option disabled> </option><!></select></div> <!> <div><label class="form-label mb-3">Kehadiran</label> <div class="grid grid-cols-2 gap-3"><label><input type="radio" name="attendance" value="true"/> <!> <span class="font-medium text-gray-700">Hadir</span></label> <label><input type="radio" name="attendance" value="false"/> <!> <span class="font-medium text-gray-700">Tidak Hadir</span></label></div></div> <!> <!> <div class="pt-2"><!></div></form></div>'),Pa=S('<div class="min-h-screen py-8 px-4"><div class="max-w-md mx-auto mb-4"><a href="/" class="inline-flex items-center gap-1 text-white/70 hover:text-white transition-colors"><!> <span>Kembali</span></a></div> <div class="text-center max-w-md mx-auto mb-8"><!> <h1 class="font-display text-3xl font-bold text-white mt-6 mb-2">Konfirmasi Kehadiran</h1> <p class="text-white/70">Isi formulir di bawah untuk konfirmasi kehadiranmu</p></div> <!></div> <!>',1);function Ia(x,h){We(h,!0);let m=_(""),d=_(""),f=_(""),p=_(""),c=_(""),o=_(null),D=_(""),T=_(!1),C=_(""),R=_(!1),Y=_(""),Z=_("info"),Ke=N(()=>e(d)?ia(e(d)):[]),Ne=N(()=>e(d)==="other"),De=N(()=>e(p)==="Lainnya"),Te=N(()=>va(la.rsvpDeadline)),ce=N(()=>e(m).trim().length>=2&&e(d)!==""&&(e(d)!=="other"||e(f).trim().length>=2)&&e(p)!==""&&(e(p)!=="Lainnya"||e(c).trim().length>=1)&&e(o)!==null&&(e(o)===!0||e(D).trim().length>=5));Ye(()=>{e(d)&&(n(p,""),n(c,""))});async function Me(b){if(b.preventDefault(),!(!e(ce)||e(T))){n(T,!0),n(C,"");try{const u=e(d)==="other"?"other":e(d),$=e(d)==="other"?e(f).trim():null,k=e(p),y=e(p)==="Lainnya"?e(c).trim():null,{data:M}=await Ce.from("attendees").select("id").eq("name",e(m).trim()).eq("school",u).maybeSingle();if(M){n(C,"Kamu sudah pernah mendaftar dengan nama dan sekolah yang sama."),n(R,!0),n(Y,e(C),!0),n(Z,"error"),n(T,!1);return}const{data:K,error:O}=await Ce.from("attendees").insert({name:e(m).trim(),school:u,school_other:$,class:k,class_other:y,is_attending:e(o),reason:e(o)?null:e(D).trim()}).select().single();if(O)throw O;const P={id:K.id,name:e(m).trim(),school:u,schoolOther:$||void 0,class:k,classOther:y||void 0,isAttending:e(o),reason:e(o)?void 0:e(D).trim(),submittedAt:new Date().toISOString()};console.log("Saving RSVP data to store:",P),ma.save(P),await new Promise(se=>setTimeout(se,100)),console.log("Redirecting to:",e(o)?"thank-you":"not-attending"),e(o)?await Se("/thank-you",{replaceState:!1}):await Se("/not-attending",{replaceState:!1})}catch(u){console.error("Error submitting RSVP:",u),n(C,"Terjadi kesalahan saat menyimpan data. Silakan coba lagi."),n(R,!0),n(Y,e(C),!0),n(Z,"error")}finally{n(T,!1)}}}var ve=Pa();na("x3tsbi",b=>{ea(()=>{aa.title="Konfirmasi Kehadiran - Celebrate Christmas"})});var ee=A(ve),ae=a(ee),me=a(ae),qe=a(me);fa(qe,{class:"w-5 h-5"}),w(2),t(me),t(ae);var te=l(ae,2),Le=a(te);ca(Le,{count:5}),w(4),t(te);var ze=l(te,2);{var Ve=b=>{var u=ba(),$=a(u),k=a($);Oe(k,{class:"w-16 h-16 text-red-500 mx-auto mb-4"});var y=l(k,6),M=a(y);Pe(M,{href:"/",variant:"secondary",children:(K,O)=>{w();var P=ge("Kembali ke Beranda");v(K,P)},$$slots:{default:!0}}),t(y),t($),t(u),v(b,u)},Ae=b=>{var u=Sa(),$=a(u),k=a($),y=a(k),M=a(y);ha(M,{class:"w-4 h-4"}),w(),t(y);var K=l(y,2);V(K),t(k);var O=l(k,2),P=a(O),se=a(P);_a(se,{class:"w-4 h-4"}),w(),t(P);var re=l(P,2),le=a(re);le.value=le.__value="";var Be=l(le);xe(Be,17,()=>oa,$e,(s,r)=>{var i=ga(),g=a(i,!0);t(i);var L={};F(()=>{U(g,e(r).label),L!==(L=e(r).value)&&(i.value=(i.__value=e(r).value)??"")}),v(s,i)}),t(re),t(O);var he=l(O,2);{var Ee=s=>{var r=xa(),i=l(a(r),2);V(i),t(r),j(i,()=>e(f),g=>n(f,g)),v(s,r)};z(he,s=>{e(Ne)&&s(Ee)})}var oe=l(he,2),ie=a(oe),He=a(ie);ua(He,{class:"w-4 h-4"}),w(),t(ie);var B=l(ie,2),q=a(B),Ie=a(q,!0);t(q),q.value=q.__value="";var Fe=l(q);xe(Fe,17,()=>e(Ke),$e,(s,r)=>{var i=$a(),g=a(i,!0);t(i);var L={};F(()=>{U(g,e(r)),L!==(L=e(r))&&(i.value=(i.__value=e(r))??"")}),v(s,i)}),t(B),t(oe);var ue=l(oe,2);{var Ue=s=>{var r=ka(),i=l(a(r),2);V(i),t(r),j(i,()=>e(c),g=>n(c,g)),v(s,r)};z(ue,s=>{e(De)&&s(Ue)})}var ne=l(ue,2),fe=l(a(ne),2),E=a(fe),H=a(E);V(H),H.__change=()=>n(o,!0);var je=l(H,2);pa(je,{class:"w-5 h-5 text-green-600"}),w(2),t(E);var de=l(E,2),I=a(de);V(I),I.__change=()=>n(o,!1);var Je=l(I,2);Oe(Je,{class:"w-5 h-5 text-red-600"}),w(2),t(de),t(fe),t(ne);var pe=l(ne,2);{var Xe=s=>{var r=ya(),i=l(a(r),2);ta(i),t(r),j(i,()=>e(D),g=>n(D,g)),v(s,r)};z(pe,s=>{e(o)===!1&&s(Xe)})}var _e=l(pe,2);{var Ge=s=>{var r=wa(),i=a(r,!0);t(r),F(()=>U(i,e(C))),v(s,r)};z(_e,s=>{e(C)&&s(Ge)})}var be=l(_e,2),Qe=a(be);{let s=N(()=>!e(ce));Pe(Qe,{type:"submit",variant:"primary",size:"lg",class:"w-full",get loading(){return e(T)},get disabled(){return e(s)},children:(r,i)=>{w();var g=ge("Kirim Konfirmasi");v(r,g)},$$slots:{default:!0}})}t(be),t($),t(u),F(()=>{B.disabled=!e(d),U(Ie,e(d)?"Pilih kelas":"Pilih sekolah terlebih dahulu"),ke(E,1,`radio-card ${e(o)===!0?"selected":""}`),ye(H,e(o)===!0),ke(de,1,`radio-card ${e(o)===!1?"selected":""}`),ye(I,e(o)===!1)}),ra("submit",$,Me),j(K,()=>e(m),s=>n(m,s)),we(re,()=>e(d),s=>n(d,s)),we(B,()=>e(p),s=>n(p,s)),v(b,u)};z(ze,b=>{e(Te)?b(Ve):b(Ae,!1)})}t(ee);var Re=l(ee,2);da(Re,{get type(){return e(Z)},get message(){return e(Y)},get visible(){return e(R)},set visible(b){n(R,b,!0)}}),v(x,ve),Ze()}sa(["change"]);export{Ia as component};
